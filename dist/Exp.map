{"version":3,"sources":["helpers/anim.js","helpers/validateEmail.js","Exp.js"],"names":["anim","A","n","g","t","e","a","o","c","q","cb","i","shift","apply","setTimeout","charAt","document","getElementById","expand","padding","margin","border","T","R","B","L","borderRadius","mutex","to","defs","iter","push","slice","call","arguments","dim","dir","d","replace","fr","timeout","w","window","s","style","getComputedStyle","currentStyle","u","exec","fn","test","fx","color","_","mx","mxv","p","z","Date","getTime","parseFloat","width","_fr","isNaN","clientWidth","clientHeight","opacity","zoom","filter","Math","round","v","ok","toRGBA","concat","rgbaIE","pop","length","join","height","RGBA","b","f","h","l","m","x","y","parseInt","module","exports","validateEmail","email","re","Exp","settings","el","attach","data","methods","model","app","bannerId","getUuid","recommendations","scoped","mounted","backdrop","branded","undefined","html","context","sdk","inPreview","__storage","loopDefinitions","initializedLoops","tracking","trigger","type","delay","self","addEventListener","inject","__exp_triggered","body","offsetY","scrollY","action","element","loaded","initializeModel","render","bindModels","bindMethods","bindAttributes","bindClose","bindFors","bindIfs","loadRecommendations","addBackdrop","addBranding","addAnimationClass","track","getEventProperties","control_group","Object","keys","forEach","value","key","defineProperty","enumerable","get","set","val","updateBindings","updateModels","updateIfs","updateAttributes","$anim","require","$validateEmail","removeBanner","bind","querySelector","createElement","innerHTML","trim","appendChild","firstChild","addStyle","rules","listify","sheet","cssRules","scopedStyle","rule","CSSStyleRule","generateScopedRule","CSSMediaRule","conditionText","parentNode","removeChild","selector","map","input","inputs","select","getAttribute","event","target","checked","template","supportedEvents","events","method","supportedAttributes","attr","elements","setAttribute","stopPropagation","preventDefault","expIfs","display","selecor","$refs","expFors","expFor","hasAttribute","split","arrayName","hash","cloneNode","removeAttribute","expForInstance","parentElement","siblingElement","nextElementSibling","remove","renderNewElement","item","overridePush","bindings","textContent","modelBindings","that","attrSelector","expAttrs","expBinds","indexOf","findLastField","insertBefore","array","original","Array","prototype","ret","css","disabled","createTextNode","inserted","selectors","selectorText","selectorsText","addAttributes","includes","cssText","backdropStyle","setStyleFromObject","branding","uuid","className","classList","add","rcm","options","recommendationId","id","size","total","callback","loadingKey","fillWithRandom","getRecommendation","list","scope","querySelectorAll","matches","firstPart","random","secondPart","toString","object","property","interactive","banner_id","banner_name","banner_type","variant_id","variant_name","interaction","location","href","path","pathname","items","dict","rec"],"mappings":"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;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzOA;;;;;AAKA,SAAS2F,aAAT,CAAuBC,KAAvB,EAA8B;AAC1B,MAAIC,KAAK,yJAAT;AACA,SAAOA,GAAG3C,IAAH,CAAQ0C,KAAR,CAAP;AACH;;AAEDH,OAAOC,OAAP,GAAiBC,aAAjB","file":"Exp.map","sourcesContent":["/** Copyright 2013 mocking@gmail.com * http://github.com/relay-zz/anim\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n   http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License. */\n\nvar anim = function(A) {\n    \"use strict\";\n    \n    A = function(n, g, t, e) {\n      var a, o, c,\n        q = [],\n        cb = function(i) {\n          //our internal callback function maintains a queue of objects \n          //that contain callback info. If the object is an array of length\n          //over 2, then it is parameters for the next animation. If the object\n          //is an array of length 1 and the item in the array is a number,\n          //then it is a timeout period, otherwise it is a callback function.\n          if(i = q.shift()) i[1] ?\n              A.apply(this, i).anim(cb) :\n              i[0] > 0 ? setTimeout(cb, i[0]*1000) : (i[0](), cb())\n        };\n    \n      if(n.charAt) n = document.getElementById(n);\n    \n      //if the 1st param is a number then treat it as a timeout period.\n      //If the node reference is null, then we skip it and run the next callback\n      //so that we can continue with the animation without throwing an error.\n      if(n > 0 || !n) g = {}, t = 0, cb(q = [[n || 0]]);\n    \n      //firefox don't allow reading shorthand CSS styles like \"margin\" so\n      //we have to expand them to be \"margin-left\", \"margin-top\", etc.\n      //Also, expanding them allows the 4 values to animate independently \n      //in the case that the 4 values are different to begin with.\n      expand(g, {padding:0, margin:0, border:\"Width\"}, [T, R, B, L]);\n      expand(g, {borderRadius:\"Radius\"}, [T+L, T+R, B+R, B+L]);\n    \n      //if we animate a property of a node, we set a unique number on the\n      //node, so that if we run another animation concurrently, it will halt\n      //the first animation. This is needed so that if we animate on mouseover\n      //and want to reverse the animation on mouseout before the mouseover\n      //is complete, they won't clash and the last animation prevails.\n      ++mutex;\n    \n      for(a in g) {\n        o = g[a];\n        if(!o.to && o.to !== 0) o = g[a] = {to: o};  //shorthand {margin:0} => {margin:{to:0}}\n    \n        A.defs(o, n, a, e);  //set defaults, get initial values, selects animation fx\n      }\n    \n      A.iter(g, t*1000, cb);\n    \n      return {\n        //this allows us to queue multiple animations together in compact syntax\n        anim: function() {\n          q.push([].slice.call(arguments));\n          return this\n        }\n      }\n    };\n    \n    var T=\"Top\", R=\"Right\", B=\"Bottom\", L=\"Left\",\n      mutex = 1,\n    \n      //{border:1} => {borderTop:1, borderRight:1, borderBottom:1, borderLeft:1}\n      expand = function(g, dim, dir, a, i, d, o) {\n        for(a in g) {  //for each animation property\n          if(a in dim) {\n            o = g[a];\n            for(i = 0; d = dir[i]; i++)  //for each dimension (Top, Right, etc.)\n              //margin => marginTop\n              //borderWidth => borderTopWidth\n              //borderRadius => borderTopRadius\n              g[a.replace(dim[a], \"\") + d + (dim[a] || \"\")] = {\n                to:(o.to === 0) ? o.to : (o.to || o), fr:o.fr, e:o.e\n              };\n            delete g[a];\n          }\n        }\n      },\n    \n      timeout = function(w, a) {\n        return w[\"r\"+a] || w[\"webkitR\"+a] || w[\"mozR\"+a] || w[\"msR\"+a] || w[\"oR\"+a]\n      }(window, \"equestAnimationFrame\");\n    \n    A.defs = function(o, n, a, e, s) {\n      s = n.style;\n      o.a = a;  //attribute\n      o.n = n;  //node\n      o.s = (a in s) ? s : n;  //= n.style || n\n      o.e = o.e || e;  //easing\n    \n      o.fr = o.fr || (o.fr === 0 ? 0 : o.s == n ? n[a] :\n            (window.getComputedStyle ? getComputedStyle(n, null) : n.currentStyle)[a]);\n    \n      o.u = (/\\d(\\D+)$/.exec(o.to) || /\\d(\\D+)$/.exec(o.fr) || [0, 0])[1];  //units (px, %)\n    \n      //which animation fx to use. Only color needs special treatment.\n      o.fn = /color/i.test(a) ? A.fx.color : (A.fx[a] || A.fx._);\n    \n      //the mutex is composed of the animating property name and a unique number\n      o.mx = \"anim_\" + a;\n      n[o.mx] = o.mxv = mutex;\n      if(n[o.mx] != o.mxv) o.mxv = null;  //test expando\n    };\n    \n    A.iter = function(g, t, cb) {\n      var _, i, o, p, e,\n        z = +new Date + t,\n    \n      _ = function() {\n        i = z - new Date().getTime();\n    \n        if(i < 50) {\n          for(o in g)\n            o = g[o],\n            o.p = 1,\n            o.fn(o, o.n, o.to, o.fr, o.a, o.e);\n    \n          cb && cb()\n    \n        } else {\n    \n          i = i/t;\n    \n          for(o in g) {\n            o = g[o];\n    \n            if(o.n[o.mx] != o.mxv) return;  //if mutex not match then halt.\n    \n            e = o.e;\n            p = i;\n    \n            if(e == \"lin\") {\n              p = 1 - p\n      \n            } else if(e == \"ease\") {\n              p = (0.5 - p)*2;\n              p = 1 - ((p*p*p - p*3) + 2)/4\n      \n            } else if(e == \"ease-in\") {\n              p = 1 - p;\n              p = p*p*p\n      \n            } else {  //ease-out\n              p = 1 - p*p*p\n            }\n            o.p = p;\n            o.fn(o, o.n, o.to, o.fr, o.a, o.e)\n          }\n          timeout ? timeout(_) : setTimeout(_, 20)\n        }\n      }\n      _();\n    };\n    \n    A.fx = {  //CSS names which need special handling\n    \n      _: function(o, n, to, fr, a, e) {  //for generic fx\n        fr = parseFloat(fr) || 0,\n        to = parseFloat(to) || 0,\n        o.s[a] = (o.p >= 1 ? to : (o.p*(to - fr) + fr)) + o.u\n      },\n    \n      width: function(o, n, to, fr, a, e) {  //for width/height fx\n        if(!(o._fr >= 0))\n          o._fr = !isNaN(fr = parseFloat(fr)) ? fr : a == \"width\" ? n.clientWidth : n.clientHeight;\n        A.fx._(o, n, to, o._fr, a, e)\n      },\n    \n      opacity: function(o, n, to, fr, a, e) {\n        if(isNaN(fr = fr || o._fr))\n          fr = n.style,\n          fr.zoom = 1,\n          fr = o._fr = (/alpha\\(opacity=(\\d+)\\b/i.exec(fr.filter) || {})[1]/100 || 1;\n        fr *= 1;\n        to = (o.p*(to - fr) + fr);\n        n = n.style;\n        if(a in n) {\n          n[a] = to\n        } else {\n          n.filter = to >= 1 ? \"\" : \"alpha(\" + a + \"=\" + Math.round(to*100) + \")\"\n        }\n      },\n    \n      color: function(o, n, to, fr, a, e, i, v) {\n        if(!o.ok) {\n          to = o.to = A.toRGBA(to);\n          fr = o.fr = A.toRGBA(fr);\n          if(to[3] == 0) to = [].concat(fr), to[3] = 0;\n          if(fr[3] == 0) fr = [].concat(to), fr[3] = 0;\n          o.ok = 1\n        }\n    \n        v = [0, 0, 0, o.p*(to[3] - fr[3]) + 1*fr[3]];\n        for(i=2; i>=0; i--) v[i] = Math.round(o.p*(to[i] - fr[i]) + 1*fr[i]);\n    \n        if(v[3] >= 1 || A.rgbaIE) v.pop();\n    \n        try {\n          o.s[a] = (v.length > 3 ? \"rgba(\" : \"rgb(\") + v.join(\",\") + \")\"\n        } catch(e) {\n          A.rgbaIE = 1\n        }\n      }\n    };\n    A.fx.height = A.fx.width;\n    \n    A.RGBA = /#(.)(.)(.)\\b|#(..)(..)(..)\\b|(\\d+)%,(\\d+)%,(\\d+)%(?:,([\\d\\.]+))?|(\\d+),(\\d+),(\\d+)(?:,([\\d\\.]+))?\\b/;\n    A.toRGBA = function(s, v) {\n      v = [0, 0, 0, 0];\n      s.replace(/\\s/g, \"\").replace(A.RGBA, function(i, a,b,c, f,g,h, l,m,n,o, w,x,y,z) {\n        var h = [a+a||f, b+b||g, c+c||h], p = [l, m, n];\n    \n        for(i=0; i<3; i++) h[i] = parseInt(h[i], 16), p[i] = Math.round(p[i]*2.55);\n    \n        v = [h[0]||p[0]||w||0,  h[1]||p[1]||x||0,  h[2]||p[2]||y||0,  o||z||1]\n      });\n      return v\n    };\n    \n    return A\n}();\n\nmodule.exports = anim;","/**\n * \n * @param {string} email \n * @returns {bool}\n */\nfunction validateEmail(email) {\n    var re = /^(([^<>()\\[\\]\\\\.,;:\\s@\"]+(\\.[^<>()\\[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\n    return re.test(email);\n}\n\nmodule.exports = validateEmail;","/* Main class */\nclass Exp {\n    constructor(settings) {\n        /* Find DOM element which contains Exp code */\n        this.el = settings.el || null;\n        /* Find DOM element to which append HTML code */\n        this.attach = settings.attach || null;\n\n        /* Initializing data model */\n        this.data = settings.data || {};\n        /* Controller methods */\n        this.methods = settings.methods || {};\n        /* Initializing model */\n        this.model = {};\n\n        /* Initialization of Exp app */\n        this.app = null;\n\n        /* Generate Id for banner */\n        this.bannerId = 'e-' + this.getUuid();\n        /* Dictionaries describing recommendations */\n        this.recommendations = settings.recommendations || {};\n\n        /* Scoping CSS rules locally for banner */\n        this.scoped = settings.scoped || false;\n        /* Function triggered after rendering the banner */\n        this.mounted = settings.mounted || null;\n        /* Backdrop in front of which Exp app will be rendered */\n        this.backdrop = settings.backdrop || null;\n        /* Adding Exponea branding options, by default black */\n        if (settings.branded === undefined || settings.branded === null || (settings.branded && settings.branded !== \"black\" && settings.branded !== \"white\")) {\n            this.branded = \"black\";\n        } else {\n            this.branded = settings.branded;\n        }\n\n        /* Look for either explicit code or for HTML code in context */\n        this.html = (_ => {\n            if (settings.html !== undefined) return settings.html;\n            if (settings.context !== undefined) {\n                if (settings.context.html !== undefined) return settings.context.html;\n            }\n            return null;\n        })();\n        /* Look for either explicit code or for CSS code in context */\n        this.style = (_ => {\n            if (settings.style !== undefined) return settings.style;\n            if (settings.context !== undefined) {\n                if (settings.context.style !== undefined) return settings.context.style;\n            }\n            return null;\n        })();\n        /* Exponea SDK passed through context attribute when using production banners */\n        this.sdk = (_ => {\n            if (settings.context !== undefined) {\n                if (settings.context.sdk !== undefined) return settings.context.sdk;\n            }\n\n            return null;\n        })();\n        /* Exponea banner context */\n        this.context = (_ => {\n            if (settings.context !== undefined) {\n                if (settings.context.data !== undefined) return settings.context.data;\n            }\n\n            return null;\n        })();\n        /* Check whether banner is in Exponea editor or not */\n        this.inPreview = (_ => {\n            if (settings.context !== undefined) {\n                if (settings.context.inPreview !== undefined) return settings.context.inPreview;\n            }\n\n            return false;\n        })();\n\n        /* Internal storage */\n        this.__storage = {\n            loopDefinitions: {},\n            initializedLoops: {}\n        };\n\n        /* Tracking by default true. Tracks show/close automatically. */\n        if (settings.tracking === undefined) {\n            this.tracking = true;\n        } else {\n            this.tracking = settings.tracking;\n        }\n        /* Setting trigger for banner display */\n        this.trigger = settings.trigger || null;\n        \n        /* If trigger exists, inject into DOM based on the type of the trigger */\n        if (this.trigger !== null && !this.inPreview) {\n            if (this.trigger.type == \"onready\") {\n                /* Renders banner once page elements are loaded */\n                const delay = this.trigger.delay || 0;\n                var self = this;\n                window.addEventListener('load', function() {\n                    setTimeout(() => {\n                        self.inject();\n                    }, delay);\n                });\n                return;\n            } else if (this.trigger.type == \"onexit\") {\n                /* Renders banner if user wants to leave the page */\n                const delay = this.trigger.delay || 0;\n                window.__exp_triggered = false;\n                var self = this;\n                document.body.addEventListener(\"mouseleave\", function (e) {\n                    /* Check window was left */\n                    if (e.offsetY - window.scrollY < 0 && !window.__exp_triggered) {\n                        window.__exp_triggered = true;\n                        setTimeout(() => {\n                            self.inject(self);\n                        }, delay);\n                    }\n                });\n                return;\n            } else if (this.trigger.type = \"onaction\") {\n                /* Renders banner on specific user action */\n                var self = this;\n                var action = this.trigger.action || \"click\";\n                const delay = this.trigger.delay || 0;\n                if (this.trigger.element) {\n                    this.trigger.element.addEventListener(action, function() {\n                        setTimeout(() => {\n                            self.inject(self);\n                        }, delay);\n                    });\n                }\n                return;\n            } else {\n                /* If incorrect type of trigger is given do not render at all */\n                throw `Incorrect trigger type ${ this.trigger.type }`;\n            }\n        }\n        /* If no trigger type inject normally */\n        return this.inject();\n    }\n\n    /* Method for injecting the banner into DOM */\n    inject() {\n        /* For control group do not inject and only track show */\n        if (false) { /* TODO: How to check control_group from context */\n            this.loaded();\n        }\n\n        /* Initialize model */\n        this.initializeModel(this.data);\n\n        /* Render Exp banner */\n        this.render();\n\n        /* Create the main tunnel of bindings between HTML with JS */\n        this.bindModels();\n        this.bindMethods();\n        this.bindAttributes();\n        this.bindClose();\n        this.bindFors();\n        this.bindIfs()\n\n        /* Load recommendations */\n        this.loadRecommendations()\n\n        /* Renders optional objects alongside with banners */\n        if (this.backdrop !== null) this.addBackdrop();\n        if (this.branded !== false) this.addBranding();\n        /* Adds exponea-animate class to app */\n        this.addAnimationClass();\n\n        /* Track show if tracking is set to true  */\n        if (this.tracking && this.sdk !== null && this.context !== null) {\n            this.sdk.track('banner', this.getEventProperties('show', false));\n        }\n\n        /* Call mounted function if set */\n        if (this.mounted !== null && !this.control_group) this.mounted.call(this.model);\n\n        return this.model;\n    }\n\n    /* Initalize model from data */\n    initializeModel(data) {\n        var self = this;\n        Object.keys(data).forEach(key => {\n            var value = data[key];\n            /* Define new setters to update model on change */\n            Object.defineProperty(self.model, key, {\n                enumerable: true,\n                get() {\n                    return value;\n                },\n                set(val) {\n                    value = val;\n                    self.updateBindings(key, value);\n                    self.updateModels(key, value);\n                    self.updateIfs(key, value);\n                    self.updateAttributes(key, value);\n                }\n            });\n            self.model[key] = value;\n        });\n\n        /* Copy methods from this.methods to this.model scope so it can be accessed with `this` */\n        if (this.methods !== null) {\n            for (var key of Object.keys(this.methods)) {\n                this.model[key] = this.methods[key];\n            }\n        }\n\n        /* Bind helper methods */\n        this.model.$anim = require('./helpers/anim.js');\n        this.model.$validateEmail = require('./helpers/validateEmail.js');\n\n        /* Bind special methods to be used in `this` scope */\n        this.model.removeBanner = this.removeBanner.bind(this, this.app);\n        this.model.sdk = this.sdk;\n    }\n\n    /* Render Exp banner by injecting it into DOM and adding style */\n    render() {\n        /* Use el to find element over which to mask Exp */\n        if (this.el !== null) {\n            this.app = document.querySelector(this.el);\n        /* Otherwise check for HTML code which would be created and injected into DOM */\n        } else if (this.html !== null) {\n            /* Insert HTML to page */\n            let el = document.createElement('div');\n            el.innerHTML = this.html.trim();\n            /* Append the element to target or to body */\n            if (this.attach !== null) {\n                this.app = document.querySelector(this.attach).appendChild(el.firstChild);\n            } else {\n                this.app = document.body.appendChild(el.firstChild);\n            }\n        } else {\n            return;\n        }\n        /* Handles CSS inserting and scoping */\n        if (this.style !== null) {\n            if (this.scoped) {\n                /* Quickly add style which is disabled, rename it and remove it */\n                let style = this.addStyle(this.style, true)\n                let rules = this.listify(style.sheet.cssRules);\n                var scopedStyle = \"\";\n                /* Iterate over CSS rules */\n                rules.forEach(rule => {\n                    /* Check rule is instances of CSSStyleRule */\n                    if (rule instanceof CSSStyleRule) {\n                        scopedStyle = scopedStyle + this.generateScopedRule(rule);\n                    }\n                    /* Rule is media query */\n                    if (rule instanceof CSSMediaRule) {\n                        scopedStyle = scopedStyle + `@media ${rule.conditionText} {`\n                        this.listify(rule.cssRules).forEach(rule => {\n                            scopedStyle = scopedStyle + this.generateScopedRule(rule);\n                        });\n                        scopedStyle = scopedStyle + `}`;\n                    }\n                });\n                /* Append scoped style */\n                this.addStyle(scopedStyle);\n                /* Remove original style */\n                style.parentNode.removeChild(style);\n            } else {\n                /* Append style with global scope */\n                this.addStyle(this.style);\n            }\n        }\n    }\n\n    /* Initial binding of input models */\n    bindModels() {\n        let selector = [\"email\", \"number\", \"search\", \"tel\", \"text\", \"url\", \"checkbox\", \"radio\"].map(input => {\n            return `input[type=\"${input}\"][exp-model]`;\n        });\n        selector = selector.concat([\"textarea[exp-model]\", \"select[exp-model]\"]);\n        /* Find all input elements */\n        var inputs = this.select(selector.join());\n        inputs.forEach(input => {\n            const model = input.getAttribute(\"exp-model\");\n            const type = input.getAttribute(\"type\");\n            /* Handle different input types */\n            if (type === \"checkbox\") {\n                input.addEventListener(\"change\", event => {\n                    this.model[model] = event.target.checked;\n                });\n            } else if (type === \"radio\") {\n                input.addEventListener(\"change\", event => {\n                    this.model[model] = event.target.value;\n                });\n            } else {\n                input.addEventListener(\"input\", event => {\n                    this.model[model] = event.target.value;\n                });\n            }\n        });\n    }\n\n    /* Initial bindings of methods */\n    bindMethods(template = undefined) {\n        var self = this;\n        let supportedEvents = [\"click\", \"submit\", \"input\", \"hover\", \"blur\", \"focus\", \"mouseenter\", \"mouseleave\"];\n        let selector = supportedEvents.map(event => {\n            return `*[exp-${event}]`;\n        });\n        var events = this.select(selector.join(), template);\n        events.forEach(el => {\n            supportedEvents.forEach(event => {\n                var method = el.getAttribute('exp-' + event);\n                if (method === null || !(method in self.methods)) return;\n                /* If exp-action is declared then add appropriate EventListener */\n                el.addEventListener(event, function(e) {\n                    self.methods[method].apply(self.model, [e]);\n                });\n            });\n        });\n    }\n\n    /* Binds DOM object attribute values with model */\n    bindAttributes() {\n        const self = this;\n        const supportedAttributes = [\"src\", \"href\", \"alt\"];\n        let selector = supportedAttributes.map(attr => {\n            return `*[exp-${attr}]`;\n        });\n        const elements = this.select(selector.join());\n        elements.forEach(el => {\n            supportedAttributes.forEach(attr => {\n                var val = el.getAttribute('exp-' + attr);\n                if (val === null || !(val in self.model)) return;\n                /* Update value according to data in model */\n                el.setAttribute(attr, self.model[val]);\n            })\n        })\n    }\n\n    /* Binds the close button with tracking and deleting functionality */\n    bindClose() {\n        let selector = `[exp-close]`;\n        var elements = this.select(selector);\n        elements.forEach(el => {\n            el.addEventListener('click', (e) => {\n                e.stopPropagation();\n                e.preventDefault();\n                this.removeBanner();\n                /* Track 'close' if tracking is set to true */\n                if (this.tracking && this.sdk !== null && this.context !== null) {\n                    this.sdk.track('banner', this.getEventProperties('close'));\n                }\n            });\n        })\n    }\n\n    /* Bind exp-ifs */ \n    bindIfs() {\n        const expIfs = this.select(`[exp-if]`);\n        expIfs.forEach(el => {\n            /* BUG: does not check the original display value, assumes block */\n            const attr = el.getAttribute(\"exp-if\");\n            if (this.model[attr] !== null && this.model[attr] !== undefined) {\n                el.style.display = (this.model[attr] ? \"block\" : \"none\");\n            } else {\n                throw `exp-if attribute ${attr} is not defined in model.`\n                this.model[attr] = null;\n            }\n        });\n    }\n\n    /* Creates access to elements from model scope */\n    bindRefs() {\n        let selecor = `[exp-ref]`;\n        var elements = this.select(selecor);\n        elements.forEach(el => {\n            let val = el.getAttribute('exp-ref');\n            if (val && val !== '') {\n                this.model.$refs[val] = el\n            }\n        });\n    }\n\n    /* Instantiates and binds exp-for with model */\n    bindFors() {\n        const expFors = this.select(`[exp-for], [exp-rcm]`);\n        expFors.forEach(expFor => {\n            /* Tokenize and parse attribute */\n            let attr = expFor.hasAttribute('exp-for') ? 'exp-for' : 'exp-rcm';\n            let key = expFor.getAttribute(attr).split(' ')[0];\n            let arrayName = expFor.getAttribute(attr).split(' ')[2];\n            let hash = 'e-' + this.getUuid();\n            let template = expFor.cloneNode(true);\n            /* Delete exp-for attribute */\n            template.removeAttribute(\"exp-for\");\n            /* Copy template into storage, with the root element */\n            const expForInstance = {\n                template: template,\n                parentElement: expFor.parentNode,\n                siblingElement: expFor.nextElementSibling\n            };\n            if (arrayName in this.__storage.loopDefinitions) {\n                this.__storage.loopDefinitions[arrayName].push(expForInstance);\n            } else {\n                this.__storage.loopDefinitions[arrayName] = [expForInstance];\n            };\n            /* Remove all children elements */\n            expFor.remove();\n            /* Check if array exists in model and render multiple templates */\n            if (this.model[arrayName]) {\n                this.model[arrayName].forEach(item => {\n                    this.renderNewElement(arrayName, key, item, expForInstance);\n                });\n            } else {\n                this.model[arrayName] = [];\n            }\n            /* Override the push method of array in the model for reactivity */\n            this.overridePush(this.model[arrayName], arrayName, key);\n        });\n    }\n\n    /* Method for updating all exp-binds */\n    updateBindings(key, value) {\n        const bindings = this.select(`*[exp-bind=\"${key}\"]`);\n        bindings.forEach(el => {\n            el.textContent = value;\n        });\n    }\n\n    /* Method for updating input exp-models */\n    updateModels(key, value) {\n        const modelBindings = this.select(`*[exp-model=\"${key}\"]`);\n        modelBindings.forEach(input => {\n            const model = input.getAttribute(\"exp-model\");\n            const type = input.getAttribute(\"type\");\n            /* Handle different input types */\n            if (type == \"checkbox\") {\n                input.checked = !!value;\n            } else if (type == \"radio\") {\n                if (input.value == value) input.checked = true;\n            } else {\n                input.value = value;\n            }\n        });\n    }\n\n    /* Method for updating exp-ifs */ \n    updateIfs(key, value) {\n        const expIfs = this.select(`*[exp-if=\"${key}\"]`);\n        expIfs.forEach(el => {\n            /* BUG: does not check the original display value, assumes block */\n            el.style.display = (value ? \"block\" : \"none\");\n        });\n    }\n\n    /* Method for updating attributes */\n    updateAttributes(key, value) {\n        const supportedAttributes = [\"src\", \"href\", \"alt\"];\n        let selector = supportedAttributes.map(attr => {\n            return `*[exp-${attr}=\"${key}\"]`;\n        });\n        const that = this;\n        const elements = this.select(selector.join());\n\n        elements.forEach(el => {\n            supportedAttributes.forEach(attr => {\n                var val = el.getAttribute('exp-' + attr);\n                if (val === null || !(val in that.model)) return;\n                \n                el[attr] = that.model[val];\n            })\n        });\n    }\n\n\n    /* Renders a new element of an array */\n    renderNewElement(arrayName, key, item, expFor = null) {\n        const supportedAttributes = [\"src\", \"href\", \"alt\"];\n        var expFors;\n        if (expFor !== null) {\n            expFors = [expFor];\n        } else {\n            expFors = this.__storage.loopDefinitions[arrayName];\n        }\n        /* Iterate through all exp-for instances linked to targeted array */\n        for (expForInstance of expFors) {\n            /* Clone the template and populate it with element data */\n            var template = expForInstance.template.cloneNode(true);\n            let attrSelector = supportedAttributes.map(attr => {\n                return `*[exp-${attr}]`;\n            });\n            const expAttrs = this.select(attrSelector.join(), template);\n            const expBinds = this.select(`[exp-bind]`, template);\n            /* Override attributes of the node */\n            expAttrs.forEach(el => {\n                supportedAttributes.forEach(attr => {\n                    const val = el.getAttribute('exp-' + attr);\n                    if (val === null) return;\n                    if (val.indexOf('.') == -1) {\n                        el[attr] = item;\n                    } else {\n                        const keys = val.split('.');\n                        const value = this.findLastField(keys.slice(1), item);\n                        el[attr] = value;\n                    };\n                });\n            });\n            /* Override inner value of the node */\n            expBinds.forEach(el => {\n                const val = el.getAttribute('exp-bind');\n                if (val.indexOf('.') == -1) {\n                    el.textContent = item;\n                } else {\n                    const keys = val.split('.');\n                    var value = this.findLastField(keys.slice(1), item);\n                    el.textContent = value\n                }\n            });\n            /* Append all children of the newly populated template */\n            expForInstance.parentElement.insertBefore(template, expForInstance.siblingElement);\n        }\n    }\n\n    /* Override the push function with reactivity functionality */\n    overridePush(array, arrayName, key) {\n        let self = this;\n        array.push = (_ => {\n            var original = Array.prototype.push;\n            return function() {\n                const ret = original.apply(this, arguments);\n                self.renderNewElement(arrayName, key, arguments[0]);\n                return ret;\n            };\n        })();\n    }\n\n    /* Method for inserting stylesheet */\n    addStyle(css, disabled = false){\n        if (this.app === null) return;\n        var style = document.createElement('style');\n        style.type= 'text/css';\n        style.appendChild(document.createTextNode(css)); /* BUG: Does not work in IE8 or less */\n        var inserted = this.app.appendChild(style);\n        inserted.sheet.disabled = disabled;\n        return inserted;\n    }\n\n    /* Method for adding unique ID to CSS selectors */\n    generateScopedRule(rule) {\n        let selectors = rule.selectorText.split(',');\n        let selectorsText = selectors.map(selector => {\n            let attr = `exp-${this.getUuid()}`;\n            this.addAttributes(selector.trim(), attr);\n            if (selector.includes(\".exponea-animate\")) {\n                return `${selector}[${this.bannerId}]`\n            }\n            if (this.select(selector.trim()).length > 0) {\n                return `${selector}[${attr}]`;\n            }\n            return  `${selector}`;\n        });\n        return `${selectorsText.join()} { ${rule.style.cssText} }`;\n    }\n\n    /* Handle backdrop option */\n    addBackdrop() {\n        if (this.app == null) return;\n        /* Set default backdrop style */\n        let backdropStyle = { \n            \"position\": \"fixed\",\n            \"top\": \"0\",\n            \"left\": \"0\",\n            \"width\": \"100vw\",\n            \"height\": \"100vh\",\n            \"z-index\": \"9999\",\n            \"background\": \"rgba(0,0,0,0.7)\"\n        }\n        /* Customize backdrop. If style=true then iterates over an empty array */\n        for (var key of Object.keys(this.backdrop)) {\n            backdropStyle[key] = this.backdrop[key];\n        }\n        /* Inject element into DOM */\n        let backdrop = document.createElement('div');\n        this.setStyleFromObject(backdropStyle, backdrop);\n        this.app.parentNode.style['position'] = \"relative\";\n        this.app.style[\"z-index\"] = \"9999999\";\n        this.backdrop = this.app.parentNode.appendChild(backdrop);\n        /* Add event listener which removes banner on click */\n        this.backdrop.addEventListener('click', (e) => {\n            e.stopPropagation();\n            e.preventDefault();\n            this.removeBanner();\n        })\n    }\n\n    /* Adds Powered by Exponea branding */\n    addBranding() {\n        if (this.app === null) return;\n        var branding = document.createElement('object');\n        var uuid = this.getUuid();\n        this.app.appendChild(branding);\n        branding.innerHTML = '<a href=\"https://exponea.com/?utm_campaign=exponea-web-layer&amp;utm_medium=banner&amp;utm_source=referral\" e' + uuid + ' target=\"_blank\">Powered by Exponea</a>';\n        this.addStyle('[e' + uuid + ']{font-size:11px;position:absolute;color:' + this.branded + ';opacity:.6;right:5px;bottom:5px;padding-top:0;text-decoration:none}[e' + uuid + ']:hover{opacity:.9}');\n    }\n\n    /* Adds exponea-animate class which is responsible for smooth transitions */\n    addAnimationClass(className = \"exponea-animate\") {\n        if (this.app === null) return;\n        if (this.app.classList) {\n            this.app.setAttribute(this.bannerId, '');\n            this.app.classList.add(className);\n        } else {\n            this.app.className += ' ' + className;\n        }\n    }\n\n    /* Loads Exponea recommendation and inserts into model */\n    loadRecommendations() {\n        Object.keys(this.recommendations).forEach((rcm) => {\n            /* Has to already exist due to exp-for initialization */\n            if (this.model[rcm]) {\n                /* Option parameters according to Exponea JS SDK */\n                var options = {\n                    recommendationId: this.recommendations[rcm].id,\n                    size: this.recommendations[rcm].total,\n                    callback: data => {\n                        /* Push to model */\n                        if (data && data.length > 0) {\n                            data.forEach(item => {\n                                this.model[rcm].push(item)\n                            })\n                        }\n                        /* Update loading key */\n                        if (this.recommendations[rcm].loadingKey !== undefined) {\n                            this.model[this.recommendations[rcm].loadingKey] = true;\n                        }\n                    },\n                    fillWithRandom: true\n                };\n                /* Generate recommendation */\n                if (this.sdk && this.sdk.getRecommendation) {\n                    this.sdk.getRecommendation(options);\n                } else {\n                    if (this.recommendations[rcm].loadingKey !== undefined) {\n                        this.model[this.recommendations[rcm].loadingKey] = true;\n                    }\n                }\n            }\n        })\n    }\n\n    /* Remove banner */\n    removeBanner() {\n        if (this.app === null) return\n        this.app.parentNode.removeChild(this.app);\n        if (this.backdrop !== null) this.backdrop.parentNode.removeChild(this.backdrop);\n    }\n\n    /**\n     * Helper functions\n     */\n\n    /* Return Array from DOM elements collection list */\n    listify(list) {\n        return Array.prototype.slice.call(list);\n    }\n    /* Return array from querySelector */\n    select(selector, scope = this.app) {\n        if (scope === null) return []\n        var elements = this.listify(scope.querySelectorAll(selector));\n        if (scope.matches(selector)) {\n            elements.push(scope);\n        }\n        return elements;\n    }\n    /* Helper method for adding attribute, used by CSS scoping */\n    addAttributes(selector, attr, val = \"\") {\n        this.select(selector).forEach(el => {\n            el.setAttribute(attr, val);\n        })\n    }\n    /* Helper method for generating unique IDs, used by CSS scoping */\n    getUuid() {\n        var firstPart = (Math.random() * 46656) | 0;\n        var secondPart = (Math.random() * 46656) | 0;\n        firstPart = (\"000\" + firstPart.toString(36)).slice(-3);\n        secondPart = (\"000\" + secondPart.toString(36)).slice(-3);\n        return firstPart + secondPart;\n    }\n    /* Add inline style to element */\n    setStyleFromObject(object, el) {\n        for (var property in object) {\n            el.style[property] = object[property];\n        }\n    }\n    /* Helper method for creating event attributes for tracking */\n    getEventProperties(action, interactive) {\n        if (this.context === null) return;\n        return { \n            action: action,\n            banner_id: this.context.banner_id,\n            banner_name: this.context.banner_name,\n            banner_type: this.context.banner_type,\n            variant_id: this.context.variant_id,\n            variant_name: this.context.variant_name,\n            interaction: interactive !== false ? true : false,\n            location: window.location.href,\n            path: window.location.pathname\n        };\n    }\n    /* Helper method for finding nested fields in nested dictionaries */\n    findLastField(items, dict) {\n        if (items.length == 1) return dict[items[0]];\n        else return rec(items.slice(1), dict[items[0]]);\n    }\n}\n\nwindow.Exp = Exp;\n"]}